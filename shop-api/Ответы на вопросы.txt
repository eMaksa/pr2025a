1.Зачем нужен header('Content-Type: application/json')
Этот заголовок сообщает браузеру или клиенту,что сервер отправляет данные в формате JSON,а не в каком то другом формате.

2.Что такое SQL-инъекция и как подготовленные выражения защищают от нее.
SQl‑инъекция—это когда злоумышленник вставляет код в запрос,а подготовленные выражения защищают,разделяя данные и структуру

3.Как они сгруппировали плоский результат JOIN-запроса в вложенный JSON
Мы просто взяли строки с одинаковым ключом и собрали связанные данные в массив внутри объекта.